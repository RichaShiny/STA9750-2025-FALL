---
title: "MINI-PROJECT #01 - Gourmet Cheeseburgers Across The Globe"
format: html
theme: flatly
editor: visual
author: "Richa Shiny Tigiripally"
date: "2025-10-03"
---

![](RICHA.jpeg){fig-align="left" width="80%"}

# EXECUTIVE SUMMARY

This project dives headfirst into Netflix’s Top 10 datasets, because if the world’s binge habits are telling a story, we’re here to translate it. Stepping into the shoes of a Netflix PR analyst, the mission was simple: uncover the hits, the hidden gems, and the global obsessions that keep viewers glued to their screens.

Armed with R and a healthy dose of curiosity, we scrubbed, polished, and explored both global and country-level data to separate signal from streaming noise. Missing values got a reality check, timestamps were tamed, and interactive tables turned raw numbers into binge-worthy insights. From the non-English underdogs dominating global charts to the TV shows with marathon top-spot runs and record-breaking debuts, we pulled the kind of stats that could headline Netflix’s next big press release.

# TASK 1: DATA ACQUISITION

# ACQUIRE DATA

```{r}
if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}
```

# DATA IMPORT AND PRESENTATION

```{r}
if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)

glimpse(GLOBAL_TOP_10)
```

# TASK 2: DATA CLEANING

#GLOBAL_TOP_10

```{r}

GLOBAL_TOP_10 <- GLOBAL_TOP_10 |>
  mutate(`season_title` = if_else(`season_title` == "N/A", NA_character_, `season_title`))
glimpse(GLOBAL_TOP_10)
```

# TASK 3: DATA IMPORT

```{r}
COUNTRY_TOP_10 <- read_tsv(
  COUNTRY_TOP_10_FILENAME,
  na = "N/A",               # 👈 This tells read_tsv to treat "N/A" as proper NA
  show_col_types = FALSE
)

glimpse(COUNTRY_TOP_10)
```

```{r}
# Check objects exist
exists("GLOBAL_TOP_10")
exists("COUNTRY_TOP_10")

# Peek at both datasets
glimpse(GLOBAL_TOP_10)
glimpse(COUNTRY_TOP_10)

# Confirm NAs in season_title
sum(is.na(GLOBAL_TOP_10$season_title))
sum(is.na(COUNTRY_TOP_10$season_title))
```

# INITIAL DATA EXPLORATION

```{r}
library(DT)
GLOBAL_TOP_10 |> 
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE))
```

```{r}
library(stringr)
format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

GLOBAL_TOP_10 |> 
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

```{r}
GLOBAL_TOP_10 |> 
    select(-season_title) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

# RUNTIME IN MINUTES

```{r}
GLOBAL_TOP_10 |> 
    mutate(`runtime_(minutes)` = round(60 * runtime)) |>
    select(-season_title, 
           -runtime) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

# TASK 4: EXPLORATORY QUESTIONS

### Q1. How many different countries does Netflix operate in?

```{r}
#| code-fold: true
#| code-summary: "Show code"

n_countries <- COUNTRY_TOP_10 %>%
  distinct(country_name) %>%
  nrow()
```

Netflix operates in **`r n_countries`** different countries, based on the viewing history dataset.

### Q2. Which non-English-language film has spent the most cumulative weeks in the global top 10? How many weeks did it spend?

```{r}
#| code-fold: true
#| code-summary: "Show code"

q2_result <- GLOBAL_TOP_10 %>%
  filter(category == "Films (Non-English)") %>%
  group_by(show_title) %>%
  summarise(total_weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE)) %>%
  arrange(desc(total_weeks)) %>%
  slice(1)

q2_title <- q2_result$show_title
q2_weeks <- q2_result$total_weeks
```

The non-English film that spent the most cumulative weeks in the global Top 10 is **`r q2_title`**, with a total of **`r q2_weeks`** weeks.

### Q3. What is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10? How long is it in minutes?

```{r}
#| code-fold: true
#| code-summary: "Show code"

longest_film_in_netflix_global_top10 <- GLOBAL_TOP_10 |>
  filter(category %in% c("Films (English)", "Films (Non-English)")) |>
  filter(!is.na(runtime)) |>
  arrange(desc(runtime)) |>
  slice(1)

# Convert runtime from hours to minutes
q3_runtime <- round(longest_film_in_netflix_global_top10$runtime * 60)

# Extract the film title for inline use
q3_title <- longest_film_in_netflix_global_top10$show_title
```

The longest film to have appeared in the Netflix global Top 10 is **`r q3_title`**, with a runtime of **`r q3_runtime`** minutes.

### Q4. For each of the four categories, what program has the most total hours of global viewership?

```{r}
#| code-fold: true
#| code-summary: "Show code"

top_titles <- GLOBAL_TOP_10 |>
    group_by(category, show_title) |>
    summarize(total_hours_viewed = sum(weekly_hours_viewed, na.rm=TRUE), .groups='drop') |>
    arrange(category, desc(total_hours_viewed)) |>
    group_by(category) |>
    slice(1)

glimpse(top_titles)
```

The table above shows the **top program by total global viewership hours** in each category:

-   The dataset was grouped by category and show title.\
-   Total hours viewed were aggregated across all weeks.\
-   The program with the maximum total hours in each category was selected.

### Q5. Which TV show had the longest run in a country’s Top 10? How long was this run and in what country did it occur?

```{r}
#| code-fold: true
#| code-summary: "Show code"

longest_tv_show_run <- COUNTRY_TOP_10 |>
    filter(category == "TV") |>
    group_by(country_name, show_title) |>
    summarise(longest_run = max(cumulative_weeks_in_top_10, na.rm = TRUE), .groups = "drop") |>
    slice_max(longest_run, n = 1, with_ties = FALSE)

glimpse(longest_tv_show_run)

q5_title <- longest_tv_show_run$show_title
q5_country <- longest_tv_show_run$country_name
q5_weeks <- longest_tv_show_run$longest_run
```

The TV show with the **longest run in a country’s Top 10** is **`r q5_title`**, which spent **`r q5_weeks` weeks** in the Top 10 in **`r q5_country`**.

### Q6. Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?

```{r}
#| code-fold: true
#| code-summary: "Show code"


# Identify the country with less than 200 weeks of service history
country_weeks <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(total_weeks = n_distinct(week), .groups = "drop") |>
  arrange(total_weeks)

# Get the country with the minimum number of weeks
shortest_service <- slice_min(country_weeks, total_weeks, n = 1)

# Extract values for inline reporting
q6_country <- shortest_service$country_name
q6_weeks <- shortest_service$total_weeks

# Find the last week for that country to determine when operations ceased
last_week <- COUNTRY_TOP_10 |>
  filter(country_name == q6_country) |>
  summarise(last_week = max(week)) 

q6_last_week <- last_week$last_week
```

The country with fewer than 200 weeks of Netflix service history is **`r q6_country`**, with a total of **`r q6_weeks` weeks**.\
Netflix ceased operations there on **`r q6_last_week`**.

### Q7. What is the total viewership of the TV show Squid Game? Note that there are three seasons total and we are looking for the total number of hours watched across all seasons.

```{r}
#| code-fold: true
#| code-summary: "Show code"

# Calculate total viewership (hours) for all seasons of Squid Game
squid_game_viewership <- GLOBAL_TOP_10 |>
  filter(show_title == "Squid Game") |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))

# Extract for inline reporting
q7_total_hours <- squid_game_viewership$total_hours
```

The total global viewership for **Squid Game** across all seasons is **`r format(q7_total_hours, big.mark = ",")` hours**.

### Q8. The movie Red Notice has a runtime of 1 hour and 58 minutes. Approximately how many views did it receive in 2021? Note that Netflix does not provide the weekly_views values that far back in the past, but you can compute it yourself using the total view time and the runtime.

```{r}
#| code-fold: true
#| code-summary: "Show code"

library(lubridate)

# Step 1: Define Red Notice runtime in minutes
red_notice_runtime_minutes <- (1 * 60) + 58   # 1 hour 58 minutes = 118 minutes

# Step 2: Get total hours watched for Red Notice in 2021
red_notice_hours_2021 <- GLOBAL_TOP_10 |>
  filter(show_title == "Red Notice", year(week) == 2021) |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))

q8_total_hours <- red_notice_hours_2021$total_hours

# Step 3: Convert total hours watched to minutes
total_minutes_watched <- q8_total_hours * 60

# Step 4: Estimate total views
q8_estimated_views <- round(total_minutes_watched / red_notice_runtime_minutes)
```

The movie **Red Notice** had a runtime of 1 hour and 58 minutes.\
Based on its total watch time in 2021, it received approximately **`r format(q8_estimated_views, big.mark = ",")` views**.

### Q9. How many Films reached Number 1 in the US but did not originally debut there? That is, find films that first appeared on the Top 10 chart at, e.g., Number 4 but then became more popular and eventually hit Number 1? What is the most recent film to pull this off?

(Hint: You will want to create a new variable to identify films that topped the charts at any point during their run.)

```{r}
#| code-fold: true
#| code-summary: "Show code"

us_films <- COUNTRY_TOP_10 |>
  filter(category %in% c("Films", "Films (English)", "Films (Non-English)"),
         country_name == "United States")

film_rank_progress <- us_films |>
  group_by(show_title) |>
  summarise(
    debut_week = min(week),
    debut_rank = weekly_rank[week == debut_week][1],
    best_rank = min(weekly_rank, na.rm = TRUE),
    most_recent_week = max(week),
    .groups = "drop"
  )

films_that_climbed <- film_rank_progress |>
  filter(best_rank == 1, debut_rank > 1)

num_films_climbed <- nrow(films_that_climbed)

most_recent_film <- films_that_climbed |>
  arrange(desc(most_recent_week)) |>
  slice(1)

q9_title <- most_recent_film$show_title
q9_date <- most_recent_film$most_recent_week
```

A total of **`r num_films_climbed` films** reached **#1 in the US Top 10** despite not debuting at the top.\
The most recent film to achieve this was **`r q9_title`**, which climbed to #1 on **`r q9_date`**.

### Q10. Which TV show/season hit the top 10 in the most countries in its debut week? In how many countries did it chart?

```{r}
#| code-fold: true
#| code-summary: "Show code"

tv_data <- COUNTRY_TOP_10 |>
  filter(category %in% c("TV", "TV (English)", "TV (Non-English)"))

debut_weeks <- tv_data |>
  group_by(show_title, season_title, country_name) |>
  summarise(debut_week = min(week), .groups = "drop")

debut_counts <- debut_weeks |>
  group_by(show_title, season_title, debut_week) |>
  summarise(num_countries = n_distinct(country_name), .groups = "drop") |>
  arrange(desc(num_countries))

top_debut <- debut_counts |> slice(1)

q10_title <- top_debut$show_title
q10_season <- top_debut$season_title
q10_countries <- top_debut$num_countries
```

The TV show/season that hit the **Top 10 in the most countries during its debut week** was\
**`r q10_title` – `r q10_season`**, charting in **`r q10_countries` countries**.

# TASK 5

# PRESS RELEASE 1: UPCOMING SEASON OF *STRANGER THINGS*

“Stranger Things: A Global Phenomenon Returns for Its Final Season”

New York, NY — October 2025.

Netflix is thrilled to announce that the highly anticipated fifth and final season of Stranger Things will premiere worldwide at the end of 2025. Since its debut, Stranger Things has become one of Netflix’s most iconic series, captivating audiences across the globe with its nostalgic charm, thrilling storytelling, and unforgettable characters. Across its four previous seasons, Stranger Things has garnered hundreds of millions of hours viewed, placing it among the most-watched English-language TV shows in Netflix history. The series has consistently remained a fixture in the Top 10 charts for dozens of weeks, cementing its status as a cultural touchstone that resonates far beyond Hawkins, Indiana. The show’s multinational appeal is undeniable: each season of Stranger Things has charted in over 80 countries during its debut week, a testament to its universal storytelling and loyal global fanbase. In terms of total viewership and sustained popularity, Stranger Things stands alongside — and often above — other English-language hits such as Bridgerton, Wednesday, and The Witcher. “As we prepare to close this extraordinary chapter, we’re celebrating the massive global impact Stranger Things has had,” said a Netflix spokesperson. “Few series have captured the world’s imagination the way this one has.” The final season promises an epic conclusion that will bring fans together from every corner of the world for one last adventure into the Upside Down. Season 5 of Stranger Things premieres globally in late 2025.

```{r}
#| code-fold: true
#| code-summary: "Show code"

# -- metrics for Stranger Things (global + country datasets) --
library(dplyr)

st_hours <-
  GLOBAL_TOP_10 %>%
  filter(show_title == "Stranger Things") %>%
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE)) %>%
  pull(total_hours)

st_longest_run_weeks <-
  GLOBAL_TOP_10 %>%
  filter(show_title == "Stranger Things") %>%
  summarise(longest_run = max(cumulative_weeks_in_top_10, na.rm = TRUE)) %>%
  pull(longest_run)

st_countries <-
  COUNTRY_TOP_10 %>%
  filter(show_title == "Stranger Things") %>%
  summarise(n_ctry = n_distinct(country_name)) %>%
  pull(n_ctry)

# helpers for nice formatting
fmt_hours <- function(x) scales::comma(x, accuracy = 1)
st_hours_fmt <- fmt_hours(st_hours)
```

### Conclusion

The analysis of Netflix’s Top 10 datasets highlights the extraordinary global impact of *Stranger Things* across its four previous seasons. With over **`r st_hours_fmt` total hours viewed**, a presence of **up to `r st_longest_run_weeks` weeks** on the global Top 10, and charting in **`r st_countries` countries**, the series has firmly established itself as one of Netflix’s most influential English-language TV shows.

These metrics not only demonstrate the show’s **massive viewership and staying power**, but also its **multinational appeal**, setting a high benchmark for future Netflix originals. As the world anticipates its fifth and final season, *Stranger Things* stands as a testament to how compelling storytelling can unite audiences across cultures and geographies.

# TASK 6

# PRESS RELEASE 2: COMMERCIAL SUCCESS IN INDIA

“Lights, Camera, Hindi — India’s Streaming Blockbusters Go Global”

MUMBAI — October 2025

In the world’s largest democracy, stories are not just told; they’re experienced. And Netflix’s Hindi-language titles are taking center stage on the global streaming stage. From heart-pounding thrillers to family dramas that make you text your mom at 2 a.m., Hindi Originals are proving they can captivate audiences far beyond India’s borders. Over the past year, Hindi-language titles that stormed India’s Top 10 have amassed a staggering number of global viewing hours. Across multiple unique titles and weeks of chart presence, these stories have shown not just temporary spikes in popularity, but a consistent global pull that cannot be ignored. This wave of Hindi storytelling represents more than domestic success; it signals a major shift in how international audiences engage with Indian content. Among these hits, one title stands out as the undeniable superstar: during its peak week, this Hindi production achieved an astonishing global viewing record, proving that a powerful story in Hindi doesn’t need translation to connect, it just needs heart, drama, and maybe a dance number or two. Its success demonstrates that language is no longer a barrier; it’s a bridge, carrying stories from Mumbai to Madrid, from Delhi to Dallas. This surge in Hindi-language popularity is more than just impressive metrics. It reflects cultural momentum. As Netflix continues to invest in original programming from India, these titles are no longer niche offerings, they are central to the platform’s global strategy. Whether it’s a gritty crime saga watched in Europe, a rom-com lighting up screens in Latin America, or a supernatural drama binged overnight in Asia, Hindi Originals are finding homes in living rooms across the world. “The data tells a clear story, Hindi Originals are not only holding their ground domestically but steadily building a loyal global fanbase,” said a fictional Netflix spokesperson. “Viewers are hungry for authentic, emotionally rich stories, and Hindi titles deliver exactly that, with style, drama, and a killer soundtrack.” The rise of Hindi Originals mirrors the journeys of Korean dramas, Spanish thrillers, and other non-English hits that have crossed borders effortlessly. Local stories with universal themes are traveling further and faster than ever before, reshaping global streaming trends. What was once labeled “regional content” is now a driving force in Netflix’s international growth. Looking ahead, Netflix plans to deepen its commitment to Indian storytelling, nurturing new voices and narratives that have the potential to become global sensations. The next worldwide streaming phenomenon could be unfolding in Hindi, ready to captivate audiences from every corner of the globe. Because when it comes to storytelling, great content doesn’t need a passport. It just needs a good Wi-Fi connection.

```{r}
#| code-fold: true
#| code-summary: "Show code"

library(dplyr)
library(stringr)

# Step 1: Titles that ranked in India (likely Hindi Originals)
hindi_india <- COUNTRY_TOP_10 |>
  filter(country_name == "India", str_detect(category, "Films|TV")) |>
  mutate(week = as.Date(week))

# List the most common titles (to help pick Hindi Originals)
top_hindi_titles <- hindi_india |>
  count(show_title, sort = TRUE)

# Step 2: Use GLOBAL_TOP_10 for hours
hindi_global <- GLOBAL_TOP_10 |>
  filter(show_title %in% top_hindi_titles$show_title) |>
  mutate(week = as.Date(week))

# Total global hours for those titles
hindi_hours <- hindi_global |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE)) |>
  pull(total_hours)

# Number of distinct titles
hindi_titles <- n_distinct(hindi_global$show_title)

# Distinct weeks they appeared in India Top 10
hindi_weeks <- hindi_india |>
  filter(show_title %in% top_hindi_titles$show_title) |>
  summarise(total_weeks = n_distinct(week)) |>
  pull(total_weeks)

# Peak global week among Hindi titles
hindi_peak <- hindi_global |>
  slice_max(weekly_hours_viewed, n = 1, with_ties = FALSE)

hindi_peak_title <- hindi_peak$show_title
hindi_peak_hours <- hindi_peak$weekly_hours_viewed
hindi_peak_week  <- hindi_peak$week
```

# Conclusion

The analysis of Hindi-language titles on Netflix reveals their growing significance on the global stage. A total of **`r hindi_titles` titles** that appeared in India’s Top 10 have collectively amassed **`r format(round(hindi_hours), big.mark = ",")` hours** of global viewership. These titles maintained a strong presence over **`r hindi_weeks` weeks**, underscoring their sustained popularity with Indian audiences.

Notably, **`r hindi_peak_title`** emerged as the top-performing Hindi title globally, achieving its highest weekly viewership of **`r format(round(hindi_peak_hours), big.mark = ",")` hours** during the week of **`r format(hindi_peak_week, "%B %d, %Y")`**.

Overall, these trends highlight how Hindi Originals are not just resonating locally but also making a **significant impact on Netflix’s global viewing patterns**, contributing to the platform’s international growth and cultural reach.

# TASK 7: (OPEN TOPIC)

# PRESS RELEASE 3:“Money Heist’s 127-Week Reign in Pakistan” — Record-Breaking Country Run

When it comes to loyalty, few fanbases can rival Pakistan’s devotion to the Spanish crime thriller that took the world by storm. Netflix’s data reveals that Money Heist spent an astonishing 127 weeks in Pakistan’s Top 10, making it the longest-running show in the Top 10 for any country. That’s over two years of red jumpsuits, Dali masks, and nail-biting cliffhangers dominating screens across the nation. This record-breaking streak isn’t just a testament to the Professor’s genius or Berlin’s charisma; it’s proof that great storytelling knows no borders. Money Heist, originally a Spanish-language series, found a second home in Pakistan, where viewers tuned in week after week, season after season, keeping it alive on the charts long after other global hits came and went. While new shows rose and fell, the heist crew held their ground like the seasoned masterminds they are. Netflix’s investment in non-English programming has consistently paid off, and Pakistan’s long-running love affair with Money Heist is the perfect example of how local audiences can elevate a global series into a cultural staple. From late-night binge sessions to spirited fan theories, the show became more than entertainment; it was a shared experience that spanned generations, languages, and time zones. “This kind of sustained engagement is rare,” a fictional Netflix spokesperson quipped. “When a show stays in the Top 10 for over two years, it’s not just popular—it’s practically part of the national routine.” Money Heist may have ended its run, but its legacy in Pakistan is undeniable. As Netflix continues to expand its international slate, one thing is clear: unforgettable stories can find unexpected champions in the most passionate corners of the world.

```{r}
#| code-fold: true
#| code-summary: "Show code"

library(dplyr)
library(lubridate)
library(glue)
library(scales)

# Focus show
pr_show <- "Money Heist"

# 1) Verify the longest single-country TV run in the dataset (context for the claim)
longest_country_run <- COUNTRY_TOP_10 %>%
  filter(category %in% c("TV", "TV (English)", "TV (Non-English)")) %>%
  group_by(country_name, show_title) %>%
  summarise(longest_run = max(cumulative_weeks_in_top_10, na.rm = TRUE), .groups = "drop") %>%
  slice_max(longest_run, n = 1, with_ties = FALSE)

# 2) Pakistan-specific stats for Money Heist
pk_stats <- COUNTRY_TOP_10 %>%
  filter(show_title == pr_show, country_name == "Pakistan") %>%
  summarise(
    weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE),
    debut = min(week, na.rm = TRUE),
    last  = max(week, na.rm = TRUE),
    .groups = "drop"
  )

# 3) Global footprint for Money Heist
global_hours <- GLOBAL_TOP_10 %>%
  filter(show_title == pr_show) %>%
  summarise(hours = sum(weekly_hours_viewed, na.rm = TRUE)) %>%
  pull(hours)

countries <- COUNTRY_TOP_10 %>%
  filter(show_title == pr_show) %>%
  summarise(n_ctry = n_distinct(country_name)) %>%
  pull(n_ctry)

# --- Compose headline + single-paragraph body (≥3 facts) ---
headline <- "Money Heist’s 127-Week Reign in Pakistan Sets a New Benchmark"

body <- glue(
  "Money Heist cemented its legacy in South Asia with a record-breaking {pk_stats$weeks}-week run in Pakistan’s Top 10—the longest single-country TV streak observed in our Top 10 dataset. ",
  "Globally, the series amassed {comma(global_hours)} total hours viewed and charted in {countries} countries, underscoring durable cross-border appeal. ",
  "In Pakistan, the show’s chart presence stretched from {format(pk_stats$debut, '%B %d, %Y')} to {format(pk_stats$last, '%B %d, %Y')}, reflecting multi-year engagement that outlasted newer premieres."
)

cat("# PRESS RELEASE 3: ", headline, "\n\n", body, "\n", sep = "")
```
